!function(w){w.Hakademy=w.Hakademy||{},w.Hakademy.util=w.Hakademy.util||{},w.Hakademy.util.filterNodesByClassName=function(list,className){for(var rowList=[],i=0;i<list.length;i++)try{list[i].classList.contains(className)&&rowList.push(list[i])}catch(e){}return rowList},w.Hakademy.Reservation=function(area){var children=area.children,seat_area=Hakademy.util.filterNodesByClassName(children,"cinema-seat-area")[0];if(!seat_area)throw"cinema-seat-area가 존재하지 않습니다";var rowsize=seat_area.getAttribute("data-rowsize");if(!rowsize)throw"cinema-seat-area에 data-rowsize를 정의하십시오";this.rowsize=function(){return rowsize};var colsize=seat_area.getAttribute("data-colsize");if(!colsize)throw"cinema-seat-area에 data-colsize를 정의하십시오";this.colsize=function(){return colsize};var sendName=area.getAttribute("data-name"),width;sendName||(console.warn("data-name이 설정되지 않아 seat으로 설정됩니다"),sendName="seat");try{width=parseInt(window.getComputedStyle(seat_area,null).width)}catch(e){width=parseInt(seat_area.currentStyle.height)}this.width=function(){return width};var size=parseInt(width/colsize);this.size=function(){return size};for(var seatList=seat_area.children,cloneList=[];seatList.length>0;){var item=seatList[0],cloneNode=item.cloneNode(!0);cloneList.push(cloneNode),seat_area.removeChild(item)}for(var seat_unit=cloneList.shift(),r=1;r<=rowsize;r++)for(var c=1;c<=colsize;c++)if(cloneList.length){var rownum=parseInt(seat_unit.getAttribute("data-row")),colnum=parseInt(seat_unit.getAttribute("data-column"));rownum>rowsize||rownum<1||colnum>colsize||colnum<1||(r!=rownum||c!=colnum?appendEmptySeat(seat_area,size):(seat_unit.classList.contains("disabled")?appendDisabledSeat(seat_area,size):seat_unit.classList.contains("active")?appendActiveSeat(seat_area,size):appendNormalSeat(seat_area,size),seat_unit=cloneList.shift()))}else appendEmptySeat(seat_area,size);function clickListener(){var checkbox=this.childNodes[0];checkbox.checked=!checkbox.checked,checkbox.checked?this.classList.add("active"):this.classList.remove("active")}function appendDisabledSeat(area,size){var seat=createEmptySeat(size);seat.classList.add("disabled"),area.appendChild(seat)}function appendNormalSeat(area,size){var seat=createEmptySeat(size),checkbox=document.createElement("input");checkbox.type="checkbox",checkbox.name=sendName,checkbox.value=r+"-"+c,checkbox.style.display="none",checkbox.checked=!1,seat.appendChild(checkbox),seat.addEventListener("click",clickListener),area.appendChild(seat)}function appendActiveSeat(area,size){var seat=createEmptySeat(size),checkbox=document.createElement("input");checkbox.type="checkbox",checkbox.name=sendName,checkbox.value=r+"-"+c,checkbox.style.display="none",checkbox.checked=!0,seat.classList.add("active"),seat.appendChild(checkbox),seat.addEventListener("click",clickListener),area.appendChild(seat)}function appendEmptySeat(area,size){var seat=createEmptySeat(size);seat.classList.add("empty"),area.appendChild(seat)}function createEmptySeat(size){var seat=document.createElement("div");return seat.classList.add("cinema-seat"),seat.style.width=size+"px",seat.style.height=size+"px",seat}}}(window);